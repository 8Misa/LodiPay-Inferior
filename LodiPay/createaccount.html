<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LodiPay - Create Account</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
body { background-color:#08CB00; min-height:100vh; display:flex; justify-content:center; align-items:center; padding:20px; }
.container { width:100%; max-width:450px; }
.logo-container { text-align:center; margin-bottom:30px; }
.logo { font-size:2.5rem; font-weight:700; color:white; text-shadow:0 2px 10px rgba(0,0,0,0.2); }
.logo span { color:#FFD700; }
.card { background:rgba(255,255,255,0.95); border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,0.15); padding:40px 30px; backdrop-filter:blur(10px); transition:transform 0.3s ease; }
.card:hover { transform:translateY(-5px); }
h1 { text-align:center; color:#333; margin-bottom:10px; font-weight:600; }
.subtitle { text-align:center; color:#666; margin-bottom:30px; font-size:1rem; }
.form-group { margin-bottom:20px; position:relative; }
label { display:block; margin-bottom:8px; color:#555; font-weight:500; }
.input-with-icon { position:relative; }
.input-with-icon i { position:absolute; left:15px; top:50%; transform:translateY(-50%); color:#08CB00; z-index:1; }
input { width:100%; padding:14px 45px 14px 45px; border:2px solid #e1e5ee; border-radius:10px; font-size:16px; transition:all 0.3s ease; outline:none; position:relative; }
input:focus { border-color:#08CB00; box-shadow:0 0 0 3px rgba(8,203,0,0.2); }
.password-container { position:relative; }
.toggle-password { position:absolute; right:40px; top:50%; transform:translateY(-50%); cursor:pointer; color:#777; z-index:1; }
.btn { width:100%; padding:14px; background:linear-gradient(to right,#08CB00,#06A000); color:white; border:none; border-radius:10px; font-size:16px; font-weight:600; cursor:pointer; transition:all 0.3s ease; box-shadow:0 4px 15px rgba(8,203,0,0.3); }
.btn:hover { transform:translateY(-2px); box-shadow:0 6px 20px rgba(8,203,0,0.4); }
.btn:active { transform:translateY(0); }
.terms { text-align:center; margin:20px 0; font-size:14px; color:#666; }
.terms a { color:#08CB00; text-decoration:none; }
.terms a:hover { text-decoration:underline; }
.login-link { text-align:center; margin-top:20px; color:#666; }
.login-link a { color:#08CB00; text-decoration:none; font-weight:500; }
.login-link a:hover { text-decoration:underline; }
.divider { display:flex; align-items:center; margin:25px 0; }
.divider::before, .divider::after { content:""; flex:1; border-bottom:1px solid #e1e5ee; }
.divider span { padding:0 15px; color:#777; font-size:14px; }
.social-login { display:flex; justify-content:center; gap:15px; margin-bottom:20px; }
.social-btn { width:45px; height:45px; border-radius:50%; display:flex; align-items:center; justify-content:center; background:#f8f9fa; border:1px solid #e1e5ee; cursor:pointer; transition:all 0.3s ease; }
.social-btn:hover { transform:translateY(-3px); box-shadow:0 4px 10px rgba(0,0,0,0.1); }
.google { color:#DB4437; }
.facebook { color:#4267B2; }
.twitter { color:#1DA1F2; }
@media (max-width:480px) { .card { padding:30px 20px; } .logo { font-size:2rem; } }
</style>
</head>
<body>
<div class="container">
  <div class="logo-container">
    <div class="logo">Lodi<span>Pay</span></div>
  </div>
  <div class="card">
    <h1>Create Account</h1>
    <p class="subtitle">Join our secure payment platform</p>
    <form id="signupForm">
      <div class="form-group">
        <label for="fullname">Full Name</label>
        <div class="input-with-icon">
          <i class="fas fa-user"></i>
          <input type="text" id="fullname" placeholder="Enter your full name" required>
        </div>
      </div>
      <div class="form-group">
        <label for="email">Email Address</label>
        <div class="input-with-icon">
          <i class="fas fa-envelope"></i>
          <input type="email" id="email" placeholder="Enter your email" required>
        </div>
      </div>
      <div class="form-group">
        <label for="phone">Phone Number</label>
        <div class="input-with-icon">
          <i class="fas fa-phone"></i>
          <input type="tel" id="phone" placeholder="Enter your phone number" required>
        </div>
      </div>
      <div class="form-group">
        <label for="password">Password</label>
        <div class="input-with-icon password-container">
          <i class="fas fa-lock"></i>
          <input type="password" id="password" placeholder="Create a password" required>
          <span class="toggle-password" id="togglePassword"><i class="fas fa-eye"></i></span>
        </div>
      </div>
      <div class="form-group">
        <label for="confirmPassword">Confirm Password</label>
        <div class="input-with-icon password-container">
          <i class="fas fa-lock"></i>
          <input type="password" id="confirmPassword" placeholder="Confirm your password" required>
          <span class="toggle-password" id="toggleConfirmPassword"><i class="fas fa-eye"></i></span>
        </div>
      </div>
      <button type="submit" class="btn">Create Account</button>
    </form>
    <div class="terms">By creating an account, you agree to our <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a></div>
    <div class="login-link">Already have an account? <a href="login.html">Log In</a></div>
  </div>
</div>

<!-- Supabase + Toggle Script -->
<script type="module">
import { createClient } from 'https://esm.sh/@supabase/supabase-js';

const supabaseUrl = 'https://avuckeaolzuzveltrmrm.supabase.co';
const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF2dWNrZWFvbHp1enZlbHRybXJtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM1MTEyODgsImV4cCI6MjA3OTA4NzI4OH0.2pG6SavS6DsbUU4DHuANi88EnxpBamZ9GmGv1RuauEI'; // insert anon key
const supabase = createClient(supabaseUrl, supabaseAnonKey);

const toggleIcons = document.querySelectorAll('.toggle-password');
toggleIcons.forEach(icon => {
  icon.addEventListener('click', () => {
    const input = icon.previousElementSibling;
    if (input.type === 'password') {
      input.type = 'text';
      icon.classList.replace('bi-eye-slash', 'bi-eye');
    } else {
      input.type = 'password';
      icon.classList.replace('bi-eye', 'bi-eye-slash');
    }
  });
});

document.getElementById('signupForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  const fullname = document.getElementById('fullname').value.trim();
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value;
  const confirmPassword = document.getElementById('confirmPassword').value;

  if (password !== confirmPassword) {
    alert('Passwords do not match!');
    return;
  }

  if (password.length < 6) {
    alert('Password must be at least 6 characters long!');
    return;
  }

  // Validate email domain
  const domain = email.split('@')[1];
  if (!['gmail.com', 'yahoo.com'].includes(domain)) {
    alert('Invalid email domain. Only gmail.com or yahoo.com allowed.');
    return;
  }

  // Sign up via Supabase Auth
  const { data, error } = await supabase.auth.signUp({
    email,
    password
  });

  if (error) {
    alert('Signup failed: ' + error.message);
  } else {
    alert(`Account created! Please check your email (${email}) to verify your account.`);
    this.reset();
  }
});
</script>

<!-- Form Submission Script -->
<script>
document.getElementById('signupForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  const fullname = document.getElementById('fullname').value.trim();
  const email = document.getElementById('email').value.trim();
  const phone = document.getElementById('phone').value.trim();
  const password = document.getElementById('password').value;
  const confirmPassword = document.getElementById('confirmPassword').value;

  if (!fullname || !email || !phone || !password || !confirmPassword) {
    alert('Please fill in all fields.');
    return;
  }

  if (password !== confirmPassword) {
    alert('Passwords do not match!');
    return;
  }

  if (password.length < 6) {
    alert('Password must be at least 6 characters long!');
    return;
  }

  const { data, error } = await window.supabase.from('users').insert([{ fullname, email, phone, password }]);
  
  if (error) {
    alert('Error creating account: ' + error.message);
  } else {
    alert(`Account created successfully! Welcome, ${fullname}`);
    document.getElementById('signupForm').reset();
    window.location.href = 'login.html';
  }
});
</script>


</body>
</html>
